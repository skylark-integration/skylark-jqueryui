{"version":3,"sources":["widgets/droppable.js"],"names":["define","$","widget","version","widgetEventPrefix","options","accept","addClasses","greedy","scope","tolerance","activate","deactivate","drop","out","over","_create","proportions","o","this","isover","isout","isFunction","d","is","arguments","length","width","element","offsetWidth","height","offsetHeight","_addToManager","_addClass","ui","ddmanager","droppables","push","_splice","i","splice","_destroy","_setOption","key","value","_super","_activate","event","draggable","current","_addActiveClass","_trigger","_deactivate","_removeActiveClass","_over","currentItem","call","_addHoverClass","_out","_removeHoverClass","_drop","custom","childrenIntersection","find","not","each","inst","droppable","disabled","intersect","extend","offset","c","helper","position","positionAbs","_removeClass","isOverAxis","x","reference","size","toleranceMode","x1","absolute","left","margins","y1","top","x2","helperProportions","y2","l","t","r","b","pageY","pageX","default","prepareOffsets","j","m","type","list","addBack","droppablesLoop","visible","css","dropped","slice","dragStart","parentsUntil","on","refreshPositions","drag","greedyChild","parentInstance","parent","intersects","parents","filter","dragStop","off","uiBackCompat","hoverClass","activeClass","addClass","removeClass"],"mappings":"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","file":"../../widgets/droppable.js","sourcesContent":["/*!\r\n * jQuery UI Droppable @VERSION\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: Droppable\r\n//>>group: Interactions\r\n//>>description: Enables drop targets for draggable elements.\r\n//>>docs: http://api.jqueryui.com/droppable/\r\n//>>demos: http://jqueryui.com/droppable/\r\n\r\ndefine( [\r\n\t\t\t\"skylark-jquery\",\r\n\t\t\t\"./draggable\",\r\n\t\t\t\"./mouse\",\r\n\t\t\t\"../version\",\r\n\t\t\t\"../widget\"\r\n],function( $ ) {\r\n\r\n$.widget( \"ui.droppable\", {\r\n\tversion: \"@VERSION\",\r\n\twidgetEventPrefix: \"drop\",\r\n\toptions: {\r\n\t\taccept: \"*\",\r\n\t\taddClasses: true,\r\n\t\tgreedy: false,\r\n\t\tscope: \"default\",\r\n\t\ttolerance: \"intersect\",\r\n\r\n\t\t// Callbacks\r\n\t\tactivate: null,\r\n\t\tdeactivate: null,\r\n\t\tdrop: null,\r\n\t\tout: null,\r\n\t\tover: null\r\n\t},\r\n\t_create: function() {\r\n\r\n\t\tvar proportions,\r\n\t\t\to = this.options,\r\n\t\t\taccept = o.accept;\r\n\r\n\t\tthis.isover = false;\r\n\t\tthis.isout = true;\r\n\r\n\t\tthis.accept = $.isFunction( accept ) ? accept : function( d ) {\r\n\t\t\treturn d.is( accept );\r\n\t\t};\r\n\r\n\t\tthis.proportions = function( /* valueToWrite */ ) {\r\n\t\t\tif ( arguments.length ) {\r\n\r\n\t\t\t\t// Store the droppable's proportions\r\n\t\t\t\tproportions = arguments[ 0 ];\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Retrieve or derive the droppable's proportions\r\n\t\t\t\treturn proportions ?\r\n\t\t\t\t\tproportions :\r\n\t\t\t\t\tproportions = {\r\n\t\t\t\t\t\twidth: this.element[ 0 ].offsetWidth,\r\n\t\t\t\t\t\theight: this.element[ 0 ].offsetHeight\r\n\t\t\t\t\t};\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis._addToManager( o.scope );\r\n\r\n\t\to.addClasses && this._addClass( \"ui-droppable\" );\r\n\r\n\t},\r\n\r\n\t_addToManager: function( scope ) {\r\n\r\n\t\t// Add the reference and positions to the manager\r\n\t\t$.ui.ddmanager.droppables[ scope ] = $.ui.ddmanager.droppables[ scope ] || [];\r\n\t\t$.ui.ddmanager.droppables[ scope ].push( this );\r\n\t},\r\n\r\n\t_splice: function( drop ) {\r\n\t\tvar i = 0;\r\n\t\tfor ( ; i < drop.length; i++ ) {\r\n\t\t\tif ( drop[ i ] === this ) {\r\n\t\t\t\tdrop.splice( i, 1 );\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_destroy: function() {\r\n\t\tvar drop = $.ui.ddmanager.droppables[ this.options.scope ];\r\n\r\n\t\tthis._splice( drop );\r\n\t},\r\n\r\n\t_setOption: function( key, value ) {\r\n\r\n\t\tif ( key === \"accept\" ) {\r\n\t\t\tthis.accept = $.isFunction( value ) ? value : function( d ) {\r\n\t\t\t\treturn d.is( value );\r\n\t\t\t};\r\n\t\t} else if ( key === \"scope\" ) {\r\n\t\t\tvar drop = $.ui.ddmanager.droppables[ this.options.scope ];\r\n\r\n\t\t\tthis._splice( drop );\r\n\t\t\tthis._addToManager( value );\r\n\t\t}\r\n\r\n\t\tthis._super( key, value );\r\n\t},\r\n\r\n\t_activate: function( event ) {\r\n\t\tvar draggable = $.ui.ddmanager.current;\r\n\r\n\t\tthis._addActiveClass();\r\n\t\tif ( draggable ) {\r\n\t\t\tthis._trigger( \"activate\", event, this.ui( draggable ) );\r\n\t\t}\r\n\t},\r\n\r\n\t_deactivate: function( event ) {\r\n\t\tvar draggable = $.ui.ddmanager.current;\r\n\r\n\t\tthis._removeActiveClass();\r\n\t\tif ( draggable ) {\r\n\t\t\tthis._trigger( \"deactivate\", event, this.ui( draggable ) );\r\n\t\t}\r\n\t},\r\n\r\n\t_over: function( event ) {\r\n\r\n\t\tvar draggable = $.ui.ddmanager.current;\r\n\r\n\t\t// Bail if draggable and droppable are same element\r\n\t\tif ( !draggable || ( draggable.currentItem ||\r\n\t\t\t\tdraggable.element )[ 0 ] === this.element[ 0 ] ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( this.accept.call( this.element[ 0 ], ( draggable.currentItem ||\r\n\t\t\t\tdraggable.element ) ) ) {\r\n\t\t\tthis._addHoverClass();\r\n\t\t\tthis._trigger( \"over\", event, this.ui( draggable ) );\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_out: function( event ) {\r\n\r\n\t\tvar draggable = $.ui.ddmanager.current;\r\n\r\n\t\t// Bail if draggable and droppable are same element\r\n\t\tif ( !draggable || ( draggable.currentItem ||\r\n\t\t\t\tdraggable.element )[ 0 ] === this.element[ 0 ] ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif ( this.accept.call( this.element[ 0 ], ( draggable.currentItem ||\r\n\t\t\t\tdraggable.element ) ) ) {\r\n\t\t\tthis._removeHoverClass();\r\n\t\t\tthis._trigger( \"out\", event, this.ui( draggable ) );\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_drop: function( event, custom ) {\r\n\r\n\t\tvar draggable = custom || $.ui.ddmanager.current,\r\n\t\t\tchildrenIntersection = false;\r\n\r\n\t\t// Bail if draggable and droppable are same element\r\n\t\tif ( !draggable || ( draggable.currentItem ||\r\n\t\t\t\tdraggable.element )[ 0 ] === this.element[ 0 ] ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.element\r\n\t\t\t.find( \":data(ui-droppable)\" )\r\n\t\t\t.not( \".ui-draggable-dragging\" )\r\n\t\t\t.each( function() {\r\n\t\t\t\tvar inst = $( this ).droppable( \"instance\" );\r\n\t\t\t\tif (\r\n\t\t\t\t\tinst.options.greedy &&\r\n\t\t\t\t\t!inst.options.disabled &&\r\n\t\t\t\t\tinst.options.scope === draggable.options.scope &&\r\n\t\t\t\t\tinst.accept.call(\r\n\t\t\t\t\t\tinst.element[ 0 ], ( draggable.currentItem || draggable.element )\r\n\t\t\t\t\t) &&\r\n\t\t\t\t\t$.ui.intersect(\r\n\t\t\t\t\t\tdraggable,\r\n\t\t\t\t\t\t$.extend( inst, { offset: inst.element.offset() } ),\r\n\t\t\t\t\t\tinst.options.tolerance, event\r\n\t\t\t\t\t)\r\n\t\t\t\t) {\r\n\t\t\t\t\tchildrenIntersection = true;\r\n\t\t\t\t\treturn false; }\r\n\t\t\t} );\r\n\t\tif ( childrenIntersection ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif ( this.accept.call( this.element[ 0 ],\r\n\t\t\t\t( draggable.currentItem || draggable.element ) ) ) {\r\n\t\t\tthis._removeActiveClass();\r\n\t\t\tthis._removeHoverClass();\r\n\r\n\t\t\tthis._trigger( \"drop\", event, this.ui( draggable ) );\r\n\t\t\treturn this.element;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tui: function( c ) {\r\n\t\treturn {\r\n\t\t\tdraggable: ( c.currentItem || c.element ),\r\n\t\t\thelper: c.helper,\r\n\t\t\tposition: c.position,\r\n\t\t\toffset: c.positionAbs\r\n\t\t};\r\n\t},\r\n\r\n\t// Extension points just to make backcompat sane and avoid duplicating logic\r\n\t// TODO: Remove in 1.13 along with call to it below\r\n\t_addHoverClass: function() {\r\n\t\tthis._addClass( \"ui-droppable-hover\" );\r\n\t},\r\n\r\n\t_removeHoverClass: function() {\r\n\t\tthis._removeClass( \"ui-droppable-hover\" );\r\n\t},\r\n\r\n\t_addActiveClass: function() {\r\n\t\tthis._addClass( \"ui-droppable-active\" );\r\n\t},\r\n\r\n\t_removeActiveClass: function() {\r\n\t\tthis._removeClass( \"ui-droppable-active\" );\r\n\t}\r\n} );\r\n\r\n$.ui.intersect = ( function() {\r\n\tfunction isOverAxis( x, reference, size ) {\r\n\t\treturn ( x >= reference ) && ( x < ( reference + size ) );\r\n\t}\r\n\r\n\treturn function( draggable, droppable, toleranceMode, event ) {\r\n\r\n\t\tif ( !droppable.offset ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar x1 = ( draggable.positionAbs ||\r\n\t\t\t\tdraggable.position.absolute ).left + draggable.margins.left,\r\n\t\t\ty1 = ( draggable.positionAbs ||\r\n\t\t\t\tdraggable.position.absolute ).top + draggable.margins.top,\r\n\t\t\tx2 = x1 + draggable.helperProportions.width,\r\n\t\t\ty2 = y1 + draggable.helperProportions.height,\r\n\t\t\tl = droppable.offset.left,\r\n\t\t\tt = droppable.offset.top,\r\n\t\t\tr = l + droppable.proportions().width,\r\n\t\t\tb = t + droppable.proportions().height;\r\n\r\n\t\tswitch ( toleranceMode ) {\r\n\t\tcase \"fit\":\r\n\t\t\treturn ( l <= x1 && x2 <= r && t <= y1 && y2 <= b );\r\n\t\tcase \"intersect\":\r\n\t\t\treturn ( l < x1 + ( draggable.helperProportions.width / 2 ) && // Right Half\r\n\t\t\t\tx2 - ( draggable.helperProportions.width / 2 ) < r && // Left Half\r\n\t\t\t\tt < y1 + ( draggable.helperProportions.height / 2 ) && // Bottom Half\r\n\t\t\t\ty2 - ( draggable.helperProportions.height / 2 ) < b ); // Top Half\r\n\t\tcase \"pointer\":\r\n\t\t\treturn isOverAxis( event.pageY, t, droppable.proportions().height ) &&\r\n\t\t\t\tisOverAxis( event.pageX, l, droppable.proportions().width );\r\n\t\tcase \"touch\":\r\n\t\t\treturn (\r\n\t\t\t\t( y1 >= t && y1 <= b ) || // Top edge touching\r\n\t\t\t\t( y2 >= t && y2 <= b ) || // Bottom edge touching\r\n\t\t\t\t( y1 < t && y2 > b ) // Surrounded vertically\r\n\t\t\t) && (\r\n\t\t\t\t( x1 >= l && x1 <= r ) || // Left edge touching\r\n\t\t\t\t( x2 >= l && x2 <= r ) || // Right edge touching\r\n\t\t\t\t( x1 < l && x2 > r ) // Surrounded horizontally\r\n\t\t\t);\r\n\t\tdefault:\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n} )();\r\n\r\n/*\r\n\tThis manager tracks offsets of draggables and droppables\r\n*/\r\n$.ui.ddmanager = {\r\n\tcurrent: null,\r\n\tdroppables: { \"default\": [] },\r\n\tprepareOffsets: function( t, event ) {\r\n\r\n\t\tvar i, j,\r\n\t\t\tm = $.ui.ddmanager.droppables[ t.options.scope ] || [],\r\n\t\t\ttype = event ? event.type : null, // workaround for #2317\r\n\t\t\tlist = ( t.currentItem || t.element ).find( \":data(ui-droppable)\" ).addBack();\r\n\r\n\t\tdroppablesLoop: for ( i = 0; i < m.length; i++ ) {\r\n\r\n\t\t\t// No disabled and non-accepted\r\n\t\t\tif ( m[ i ].options.disabled || ( t && !m[ i ].accept.call( m[ i ].element[ 0 ],\r\n\t\t\t\t\t( t.currentItem || t.element ) ) ) ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// Filter out elements in the current dragged item\r\n\t\t\tfor ( j = 0; j < list.length; j++ ) {\r\n\t\t\t\tif ( list[ j ] === m[ i ].element[ 0 ] ) {\r\n\t\t\t\t\tm[ i ].proportions().height = 0;\r\n\t\t\t\t\tcontinue droppablesLoop;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tm[ i ].visible = m[ i ].element.css( \"display\" ) !== \"none\";\r\n\t\t\tif ( !m[ i ].visible ) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// Activate the droppable if used directly from draggables\r\n\t\t\tif ( type === \"mousedown\" ) {\r\n\t\t\t\tm[ i ]._activate.call( m[ i ], event );\r\n\t\t\t}\r\n\r\n\t\t\tm[ i ].offset = m[ i ].element.offset();\r\n\t\t\tm[ i ].proportions( {\r\n\t\t\t\twidth: m[ i ].element[ 0 ].offsetWidth,\r\n\t\t\t\theight: m[ i ].element[ 0 ].offsetHeight\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\tdrop: function( draggable, event ) {\r\n\r\n\t\tvar dropped = false;\r\n\r\n\t\t// Create a copy of the droppables in case the list changes during the drop (#9116)\r\n\t\t$.each( ( $.ui.ddmanager.droppables[ draggable.options.scope ] || [] ).slice(), function() {\r\n\r\n\t\t\tif ( !this.options ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif ( !this.options.disabled && this.visible &&\r\n\t\t\t\t\t$.ui.intersect( draggable, this, this.options.tolerance, event ) ) {\r\n\t\t\t\tdropped = this._drop.call( this, event ) || dropped;\r\n\t\t\t}\r\n\r\n\t\t\tif ( !this.options.disabled && this.visible && this.accept.call( this.element[ 0 ],\r\n\t\t\t\t\t( draggable.currentItem || draggable.element ) ) ) {\r\n\t\t\t\tthis.isout = true;\r\n\t\t\t\tthis.isover = false;\r\n\t\t\t\tthis._deactivate.call( this, event );\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\t\treturn dropped;\r\n\r\n\t},\r\n\tdragStart: function( draggable, event ) {\r\n\r\n\t\t// Listen for scrolling so that if the dragging causes scrolling the position of the\r\n\t\t// droppables can be recalculated (see #5003)\r\n\t\tdraggable.element.parentsUntil( \"body\" ).on( \"scroll.droppable\", function() {\r\n\t\t\tif ( !draggable.options.refreshPositions ) {\r\n\t\t\t\t$.ui.ddmanager.prepareOffsets( draggable, event );\r\n\t\t\t}\r\n\t\t} );\r\n\t},\r\n\tdrag: function( draggable, event ) {\r\n\r\n\t\t// If you have a highly dynamic page, you might try this option. It renders positions\r\n\t\t// every time you move the mouse.\r\n\t\tif ( draggable.options.refreshPositions ) {\r\n\t\t\t$.ui.ddmanager.prepareOffsets( draggable, event );\r\n\t\t}\r\n\r\n\t\t// Run through all droppables and check their positions based on specific tolerance options\r\n\t\t$.each( $.ui.ddmanager.droppables[ draggable.options.scope ] || [], function() {\r\n\r\n\t\t\tif ( this.options.disabled || this.greedyChild || !this.visible ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar parentInstance, scope, parent,\r\n\t\t\t\tintersects = $.ui.intersect( draggable, this, this.options.tolerance, event ),\r\n\t\t\t\tc = !intersects && this.isover ?\r\n\t\t\t\t\t\"isout\" :\r\n\t\t\t\t\t( intersects && !this.isover ? \"isover\" : null );\r\n\t\t\tif ( !c ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif ( this.options.greedy ) {\r\n\r\n\t\t\t\t// find droppable parents with same scope\r\n\t\t\t\tscope = this.options.scope;\r\n\t\t\t\tparent = this.element.parents( \":data(ui-droppable)\" ).filter( function() {\r\n\t\t\t\t\treturn $( this ).droppable( \"instance\" ).options.scope === scope;\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tif ( parent.length ) {\r\n\t\t\t\t\tparentInstance = $( parent[ 0 ] ).droppable( \"instance\" );\r\n\t\t\t\t\tparentInstance.greedyChild = ( c === \"isover\" );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// We just moved into a greedy child\r\n\t\t\tif ( parentInstance && c === \"isover\" ) {\r\n\t\t\t\tparentInstance.isover = false;\r\n\t\t\t\tparentInstance.isout = true;\r\n\t\t\t\tparentInstance._out.call( parentInstance, event );\r\n\t\t\t}\r\n\r\n\t\t\tthis[ c ] = true;\r\n\t\t\tthis[ c === \"isout\" ? \"isover\" : \"isout\" ] = false;\r\n\t\t\tthis[ c === \"isover\" ? \"_over\" : \"_out\" ].call( this, event );\r\n\r\n\t\t\t// We just moved out of a greedy child\r\n\t\t\tif ( parentInstance && c === \"isout\" ) {\r\n\t\t\t\tparentInstance.isout = false;\r\n\t\t\t\tparentInstance.isover = true;\r\n\t\t\t\tparentInstance._over.call( parentInstance, event );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t},\r\n\tdragStop: function( draggable, event ) {\r\n\t\tdraggable.element.parentsUntil( \"body\" ).off( \"scroll.droppable\" );\r\n\r\n\t\t// Call prepareOffsets one final time since IE does not fire return scroll events when\r\n\t\t// overflow was caused by drag (see #5003)\r\n\t\tif ( !draggable.options.refreshPositions ) {\r\n\t\t\t$.ui.ddmanager.prepareOffsets( draggable, event );\r\n\t\t}\r\n\t}\r\n};\r\n\r\n// DEPRECATED\r\n// TODO: switch return back to widget declaration at top of file when this is removed\r\nif ( $.uiBackCompat !== false ) {\r\n\r\n\t// Backcompat for activeClass and hoverClass options\r\n\t$.widget( \"ui.droppable\", $.ui.droppable, {\r\n\t\toptions: {\r\n\t\t\thoverClass: false,\r\n\t\t\tactiveClass: false\r\n\t\t},\r\n\t\t_addActiveClass: function() {\r\n\t\t\tthis._super();\r\n\t\t\tif ( this.options.activeClass ) {\r\n\t\t\t\tthis.element.addClass( this.options.activeClass );\r\n\t\t\t}\r\n\t\t},\r\n\t\t_removeActiveClass: function() {\r\n\t\t\tthis._super();\r\n\t\t\tif ( this.options.activeClass ) {\r\n\t\t\t\tthis.element.removeClass( this.options.activeClass );\r\n\t\t\t}\r\n\t\t},\r\n\t\t_addHoverClass: function() {\r\n\t\t\tthis._super();\r\n\t\t\tif ( this.options.hoverClass ) {\r\n\t\t\t\tthis.element.addClass( this.options.hoverClass );\r\n\t\t\t}\r\n\t\t},\r\n\t\t_removeHoverClass: function() {\r\n\t\t\tthis._super();\r\n\t\t\tif ( this.options.hoverClass ) {\r\n\t\t\t\tthis.element.removeClass( this.options.hoverClass );\r\n\t\t\t}\r\n\t\t}\r\n\t} );\r\n}\r\n\r\nreturn $.ui.droppable;\r\n\r\n});\r\n"]}