{"version":3,"sources":["widgets/menu.js"],"names":["define","$","widget","version","defaultElement","delay","options","icons","submenu","items","menus","position","my","at","role","blur","focus","select","_create","this","activeMenu","element","mouseHandled","lastMousePosition","x","y","uniqueId","attr","tabIndex","_addClass","_on","mousedown .ui-menu-item","event","preventDefault","_activateItem","click .ui-menu-item","target","active","ui","safeActiveElement","document","not","length","isPropagationStopped","has","expand","is","closest","trigger","parents","clearTimeout","timer","mouseenter .ui-menu-item","mousemove .ui-menu-item","mouseleave","mouseleave .ui-menu","keepActiveItem","item","_menuItems","first","_delay","notContained","contains","collapseAll","keydown","refresh","click","_closeOnDocumentClick","previousFilter","clientX","clientY","actualTarget","currentTarget","_removeClass","siblings","children","_destroy","find","removeAttr","submenus","removeUniqueId","addBack","show","each","elem","data","remove","_keydown","match","prev","character","skip","keyCode","PAGE_UP","previousPage","PAGE_DOWN","nextPage","HOME","_move","END","UP","previous","DOWN","next","LEFT","collapse","RIGHT","ENTER","SPACE","_activate","ESCAPE","toString","String","fromCharCode","filterTimer","_filterMenuItems","index","nextAll","newSubmenus","newItems","newWrappers","that","icon","_toggleClass","filter","hide","aria-hidden","aria-expanded","menu","submenuCaret","prepend","add","_isDivider","_itemRole","listbox","_setOption","key","value","_super","_setOptionDisabled","nested","focused","activeParent","type","_scrollIntoView","parent","_close","test","_startOpening","_trigger","borderTop","paddingTop","offset","scroll","elementHeight","itemHeight","_hasScroll","parseFloat","css","top","scrollTop","height","outerHeight","fromFocus","_open","extend","of","all","currentMenu","startMenu","text","newItem","isFirstItem","prevAll","isLastItem","direction","last","base","prop","escapedCharacter","replace","regex","RegExp","trim"],"mappings":"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","file":"../../widgets/menu.js","sourcesContent":["/*!\r\n * jQuery UI Menu @VERSION\r\n * http://jqueryui.com\r\n *\r\n * Copyright jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n\r\n//>>label: Menu\r\n//>>group: Widgets\r\n//>>description: Creates nestable menus.\r\n//>>docs: http://api.jqueryui.com/menu/\r\n//>>demos: http://jqueryui.com/menu/\r\n//>>css.structure: ../../themes/base/core.css\r\n//>>css.structure: ../../themes/base/menu.css\r\n//>>css.theme: ../../themes/base/theme.css\r\n\r\ndefine( [\r\n\t\t\t\"skylark-jquery\",\r\n\t\t\t\"../keycode\",\r\n\t\t\t\"../position\",\r\n\t\t\t\"../safe-active-element\",\r\n\t\t\t\"../unique-id\",\r\n\t\t\t\"../version\",\r\n\t\t\t\"../widget\"\r\n],function( $ ) {\r\n\r\nreturn $.widget( \"ui.menu\", {\r\n\tversion: \"@VERSION\",\r\n\tdefaultElement: \"<ul>\",\r\n\tdelay: 300,\r\n\toptions: {\r\n\t\ticons: {\r\n\t\t\tsubmenu: \"ui-icon-caret-1-e\"\r\n\t\t},\r\n\t\titems: \"> *\",\r\n\t\tmenus: \"ul\",\r\n\t\tposition: {\r\n\t\t\tmy: \"left top\",\r\n\t\t\tat: \"right top\"\r\n\t\t},\r\n\t\trole: \"menu\",\r\n\r\n\t\t// Callbacks\r\n\t\tblur: null,\r\n\t\tfocus: null,\r\n\t\tselect: null\r\n\t},\r\n\r\n\t_create: function() {\r\n\t\tthis.activeMenu = this.element;\r\n\r\n\t\t// Flag used to prevent firing of the click handler\r\n\t\t// as the event bubbles up through nested menus\r\n\t\tthis.mouseHandled = false;\r\n\t\tthis.lastMousePosition = { x: null, y: null };\r\n\t\tthis.element\r\n\t\t\t.uniqueId()\r\n\t\t\t.attr( {\r\n\t\t\t\trole: this.options.role,\r\n\t\t\t\ttabIndex: 0\r\n\t\t\t} );\r\n\r\n\t\tthis._addClass( \"ui-menu\", \"ui-widget ui-widget-content\" );\r\n\t\tthis._on( {\r\n\r\n\t\t\t// Prevent focus from sticking to links inside menu after clicking\r\n\t\t\t// them (focus should always stay on UL during navigation).\r\n\t\t\t\"mousedown .ui-menu-item\": function( event ) {\r\n\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\tthis._activateItem( event );\r\n\t\t\t},\r\n\t\t\t\"click .ui-menu-item\": function( event ) {\r\n\t\t\t\tvar target = $( event.target );\r\n\t\t\t\tvar active = $( $.ui.safeActiveElement( this.document[ 0 ] ) );\r\n\t\t\t\tif ( !this.mouseHandled && target.not( \".ui-state-disabled\" ).length ) {\r\n\t\t\t\t\tthis.select( event );\r\n\r\n\t\t\t\t\t// Only set the mouseHandled flag if the event will bubble, see #9469.\r\n\t\t\t\t\tif ( !event.isPropagationStopped() ) {\r\n\t\t\t\t\t\tthis.mouseHandled = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Open submenu on click\r\n\t\t\t\t\tif ( target.has( \".ui-menu\" ).length ) {\r\n\t\t\t\t\t\tthis.expand( event );\r\n\t\t\t\t\t} else if ( !this.element.is( \":focus\" ) &&\r\n\t\t\t\t\t\t\tactive.closest( \".ui-menu\" ).length ) {\r\n\r\n\t\t\t\t\t\t// Redirect focus to the menu\r\n\t\t\t\t\t\tthis.element.trigger( \"focus\", [ true ] );\r\n\r\n\t\t\t\t\t\t// If the active item is on the top level, let it stay active.\r\n\t\t\t\t\t\t// Otherwise, blur the active item since it is no longer visible.\r\n\t\t\t\t\t\tif ( this.active && this.active.parents( \".ui-menu\" ).length === 1 ) {\r\n\t\t\t\t\t\t\tclearTimeout( this.timer );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\"mouseenter .ui-menu-item\": \"_activateItem\",\r\n\t\t\t\"mousemove .ui-menu-item\": \"_activateItem\",\r\n\t\t\tmouseleave: \"collapseAll\",\r\n\t\t\t\"mouseleave .ui-menu\": \"collapseAll\",\r\n\t\t\tfocus: function( event, keepActiveItem ) {\r\n\r\n\t\t\t\t// If there's already an active item, keep it active\r\n\t\t\t\t// If not, activate the first item\r\n\t\t\t\tvar item = this.active || this._menuItems().first();\r\n\r\n\t\t\t\tif ( !keepActiveItem ) {\r\n\t\t\t\t\tthis.focus( event, item );\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tblur: function( event ) {\r\n\t\t\t\tthis._delay( function() {\r\n\t\t\t\t\tvar notContained = !$.contains(\r\n\t\t\t\t\t\tthis.element[ 0 ],\r\n\t\t\t\t\t\t$.ui.safeActiveElement( this.document[ 0 ] )\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif ( notContained ) {\r\n\t\t\t\t\t\tthis.collapseAll( event );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t},\r\n\t\t\tkeydown: \"_keydown\"\r\n\t\t} );\r\n\r\n\t\tthis.refresh();\r\n\r\n\t\t// Clicks outside of a menu collapse any open menus\r\n\t\tthis._on( this.document, {\r\n\t\t\tclick: function( event ) {\r\n\t\t\t\tif ( this._closeOnDocumentClick( event ) ) {\r\n\t\t\t\t\tthis.collapseAll( event, true );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Reset the mouseHandled flag\r\n\t\t\t\tthis.mouseHandled = false;\r\n\t\t\t}\r\n\t\t} );\r\n\t},\r\n\r\n\t_activateItem: function( event ) {\r\n\r\n\t\t// Ignore mouse events while typeahead is active, see #10458.\r\n\t\t// Prevents focusing the wrong item when typeahead causes a scroll while the mouse\r\n\t\t// is over an item in the menu\r\n\t\tif ( this.previousFilter ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// If the mouse didn't actually move, but the page was scrolled, ignore the event (#9356)\r\n\t\tif ( event.clientX === this.lastMousePosition.x &&\r\n\t\t\t\tevent.clientY === this.lastMousePosition.y ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.lastMousePosition = {\r\n\t\t\tx: event.clientX,\r\n\t\t\ty: event.clientY\r\n\t\t};\r\n\r\n\t\tvar actualTarget = $( event.target ).closest( \".ui-menu-item\" ),\r\n\t\t\ttarget = $( event.currentTarget );\r\n\r\n\t\t// Ignore bubbled events on parent items, see #11641\r\n\t\tif ( actualTarget[ 0 ] !== target[ 0 ] ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// If the item is already active, there's nothing to do\r\n\t\tif ( target.is( \".ui-state-active\" ) ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Remove ui-state-active class from siblings of the newly focused menu item\r\n\t\t// to avoid a jump caused by adjacent elements both having a class with a border\r\n\t\tthis._removeClass( target.siblings().children( \".ui-state-active\" ),\r\n\t\t\tnull, \"ui-state-active\" );\r\n\t\tthis.focus( event, target );\r\n\t},\r\n\r\n\t_destroy: function() {\r\n\t\tvar items = this.element.find( \".ui-menu-item\" )\r\n\t\t\t\t.removeAttr( \"role aria-disabled\" ),\r\n\t\t\tsubmenus = items.children( \".ui-menu-item-wrapper\" )\r\n\t\t\t\t.removeUniqueId()\r\n\t\t\t\t.removeAttr( \"tabIndex role aria-haspopup\" );\r\n\r\n\t\t// Destroy (sub)menus\r\n\t\tthis.element\r\n\t\t\t.removeAttr( \"aria-activedescendant\" )\r\n\t\t\t.find( \".ui-menu\" ).addBack()\r\n\t\t\t\t.removeAttr( \"role aria-labelledby aria-expanded aria-hidden aria-disabled \" +\r\n\t\t\t\t\t\"tabIndex\" )\r\n\t\t\t\t.removeUniqueId()\r\n\t\t\t\t.show();\r\n\r\n\t\tsubmenus.children().each( function() {\r\n\t\t\tvar elem = $( this );\r\n\t\t\tif ( elem.data( \"ui-menu-submenu-caret\" ) ) {\r\n\t\t\t\telem.remove();\r\n\t\t\t}\r\n\t\t} );\r\n\t},\r\n\r\n\t_keydown: function( event ) {\r\n\t\tvar match, prev, character, skip,\r\n\t\t\tpreventDefault = true;\r\n\r\n\t\tswitch ( event.keyCode ) {\r\n\t\tcase $.ui.keyCode.PAGE_UP:\r\n\t\t\tthis.previousPage( event );\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.PAGE_DOWN:\r\n\t\t\tthis.nextPage( event );\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.HOME:\r\n\t\t\tthis._move( \"first\", \"first\", event );\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.END:\r\n\t\t\tthis._move( \"last\", \"last\", event );\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.UP:\r\n\t\t\tthis.previous( event );\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.DOWN:\r\n\t\t\tthis.next( event );\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.LEFT:\r\n\t\t\tthis.collapse( event );\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.RIGHT:\r\n\t\t\tif ( this.active && !this.active.is( \".ui-state-disabled\" ) ) {\r\n\t\t\t\tthis.expand( event );\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.ENTER:\r\n\t\tcase $.ui.keyCode.SPACE:\r\n\t\t\tthis._activate( event );\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.ESCAPE:\r\n\t\t\tthis.collapse( event );\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tpreventDefault = false;\r\n\t\t\tprev = this.previousFilter || \"\";\r\n\t\t\tskip = false;\r\n\r\n\t\t\t// Support number pad values\r\n\t\t\tcharacter = event.keyCode >= 96 && event.keyCode <= 105 ?\r\n\t\t\t\t( event.keyCode - 96 ).toString() : String.fromCharCode( event.keyCode );\r\n\r\n\t\t\tclearTimeout( this.filterTimer );\r\n\r\n\t\t\tif ( character === prev ) {\r\n\t\t\t\tskip = true;\r\n\t\t\t} else {\r\n\t\t\t\tcharacter = prev + character;\r\n\t\t\t}\r\n\r\n\t\t\tmatch = this._filterMenuItems( character );\r\n\t\t\tmatch = skip && match.index( this.active.next() ) !== -1 ?\r\n\t\t\t\tthis.active.nextAll( \".ui-menu-item\" ) :\r\n\t\t\t\tmatch;\r\n\r\n\t\t\t// If no matches on the current filter, reset to the last character pressed\r\n\t\t\t// to move down the menu to the first item that starts with that character\r\n\t\t\tif ( !match.length ) {\r\n\t\t\t\tcharacter = String.fromCharCode( event.keyCode );\r\n\t\t\t\tmatch = this._filterMenuItems( character );\r\n\t\t\t}\r\n\r\n\t\t\tif ( match.length ) {\r\n\t\t\t\tthis.focus( event, match );\r\n\t\t\t\tthis.previousFilter = character;\r\n\t\t\t\tthis.filterTimer = this._delay( function() {\r\n\t\t\t\t\tdelete this.previousFilter;\r\n\t\t\t\t}, 1000 );\r\n\t\t\t} else {\r\n\t\t\t\tdelete this.previousFilter;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ( preventDefault ) {\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t},\r\n\r\n\t_activate: function( event ) {\r\n\t\tif ( this.active && !this.active.is( \".ui-state-disabled\" ) ) {\r\n\t\t\tif ( this.active.children( \"[aria-haspopup='true']\" ).length ) {\r\n\t\t\t\tthis.expand( event );\r\n\t\t\t} else {\r\n\t\t\t\tthis.select( event );\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\trefresh: function() {\r\n\t\tvar menus, items, newSubmenus, newItems, newWrappers,\r\n\t\t\tthat = this,\r\n\t\t\ticon = this.options.icons.submenu,\r\n\t\t\tsubmenus = this.element.find( this.options.menus );\r\n\r\n\t\tthis._toggleClass( \"ui-menu-icons\", null, !!this.element.find( \".ui-icon\" ).length );\r\n\r\n\t\t// Initialize nested menus\r\n\t\tnewSubmenus = submenus.filter( \":not(.ui-menu)\" )\r\n\t\t\t.hide()\r\n\t\t\t.attr( {\r\n\t\t\t\trole: this.options.role,\r\n\t\t\t\t\"aria-hidden\": \"true\",\r\n\t\t\t\t\"aria-expanded\": \"false\"\r\n\t\t\t} )\r\n\t\t\t.each( function() {\r\n\t\t\t\tvar menu = $( this ),\r\n\t\t\t\t\titem = menu.prev(),\r\n\t\t\t\t\tsubmenuCaret = $( \"<span>\" ).data( \"ui-menu-submenu-caret\", true );\r\n\r\n\t\t\t\tthat._addClass( submenuCaret, \"ui-menu-icon\", \"ui-icon \" + icon );\r\n\t\t\t\titem\r\n\t\t\t\t\t.attr( \"aria-haspopup\", \"true\" )\r\n\t\t\t\t\t.prepend( submenuCaret );\r\n\t\t\t\tmenu.attr( \"aria-labelledby\", item.attr( \"id\" ) );\r\n\t\t\t} );\r\n\r\n\t\tthis._addClass( newSubmenus, \"ui-menu\", \"ui-widget ui-widget-content ui-front\" );\r\n\r\n\t\tmenus = submenus.add( this.element );\r\n\t\titems = menus.find( this.options.items );\r\n\r\n\t\t// Initialize menu-items containing spaces and/or dashes only as dividers\r\n\t\titems.not( \".ui-menu-item\" ).each( function() {\r\n\t\t\tvar item = $( this );\r\n\t\t\tif ( that._isDivider( item ) ) {\r\n\t\t\t\tthat._addClass( item, \"ui-menu-divider\", \"ui-widget-content\" );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\t// Don't refresh list items that are already adapted\r\n\t\tnewItems = items.not( \".ui-menu-item, .ui-menu-divider\" );\r\n\t\tnewWrappers = newItems.children()\r\n\t\t\t.not( \".ui-menu\" )\r\n\t\t\t\t.uniqueId()\r\n\t\t\t\t.attr( {\r\n\t\t\t\t\ttabIndex: -1,\r\n\t\t\t\t\trole: this._itemRole()\r\n\t\t\t\t} );\r\n\t\tthis._addClass( newItems, \"ui-menu-item\" )\r\n\t\t\t._addClass( newWrappers, \"ui-menu-item-wrapper\" );\r\n\r\n\t\t// Add aria-disabled attribute to any disabled menu item\r\n\t\titems.filter( \".ui-state-disabled\" ).attr( \"aria-disabled\", \"true\" );\r\n\r\n\t\t// If the active item has been removed, blur the menu\r\n\t\tif ( this.active && !$.contains( this.element[ 0 ], this.active[ 0 ] ) ) {\r\n\t\t\tthis.blur();\r\n\t\t}\r\n\t},\r\n\r\n\t_itemRole: function() {\r\n\t\treturn {\r\n\t\t\tmenu: \"menuitem\",\r\n\t\t\tlistbox: \"option\"\r\n\t\t}[ this.options.role ];\r\n\t},\r\n\r\n\t_setOption: function( key, value ) {\r\n\t\tif ( key === \"icons\" ) {\r\n\t\t\tvar icons = this.element.find( \".ui-menu-icon\" );\r\n\t\t\tthis._removeClass( icons, null, this.options.icons.submenu )\r\n\t\t\t\t._addClass( icons, null, value.submenu );\r\n\t\t}\r\n\t\tthis._super( key, value );\r\n\t},\r\n\r\n\t_setOptionDisabled: function( value ) {\r\n\t\tthis._super( value );\r\n\r\n\t\tthis.element.attr( \"aria-disabled\", String( value ) );\r\n\t\tthis._toggleClass( null, \"ui-state-disabled\", !!value );\r\n\t},\r\n\r\n\tfocus: function( event, item ) {\r\n\t\tvar nested, focused, activeParent;\r\n\t\tthis.blur( event, event && event.type === \"focus\" );\r\n\r\n\t\tthis._scrollIntoView( item );\r\n\r\n\t\tthis.active = item.first();\r\n\r\n\t\tfocused = this.active.children( \".ui-menu-item-wrapper\" );\r\n\t\tthis._addClass( focused, null, \"ui-state-active\" );\r\n\r\n\t\t// Only update aria-activedescendant if there's a role\r\n\t\t// otherwise we assume focus is managed elsewhere\r\n\t\tif ( this.options.role ) {\r\n\t\t\tthis.element.attr( \"aria-activedescendant\", focused.attr( \"id\" ) );\r\n\t\t}\r\n\r\n\t\t// Highlight active parent menu item, if any\r\n\t\tactiveParent = this.active\r\n\t\t\t.parent()\r\n\t\t\t\t.closest( \".ui-menu-item\" )\r\n\t\t\t\t\t.children( \".ui-menu-item-wrapper\" );\r\n\t\tthis._addClass( activeParent, null, \"ui-state-active\" );\r\n\r\n\t\tif ( event && event.type === \"keydown\" ) {\r\n\t\t\tthis._close();\r\n\t\t} else {\r\n\t\t\tthis.timer = this._delay( function() {\r\n\t\t\t\tthis._close();\r\n\t\t\t}, this.delay );\r\n\t\t}\r\n\r\n\t\tnested = item.children( \".ui-menu\" );\r\n\t\tif ( nested.length && event && ( /^mouse/.test( event.type ) ) ) {\r\n\t\t\tthis._startOpening( nested );\r\n\t\t}\r\n\t\tthis.activeMenu = item.parent();\r\n\r\n\t\tthis._trigger( \"focus\", event, { item: item } );\r\n\t},\r\n\r\n\t_scrollIntoView: function( item ) {\r\n\t\tvar borderTop, paddingTop, offset, scroll, elementHeight, itemHeight;\r\n\t\tif ( this._hasScroll() ) {\r\n\t\t\tborderTop = parseFloat( $.css( this.activeMenu[ 0 ], \"borderTopWidth\" ) ) || 0;\r\n\t\t\tpaddingTop = parseFloat( $.css( this.activeMenu[ 0 ], \"paddingTop\" ) ) || 0;\r\n\t\t\toffset = item.offset().top - this.activeMenu.offset().top - borderTop - paddingTop;\r\n\t\t\tscroll = this.activeMenu.scrollTop();\r\n\t\t\telementHeight = this.activeMenu.height();\r\n\t\t\titemHeight = item.outerHeight();\r\n\r\n\t\t\tif ( offset < 0 ) {\r\n\t\t\t\tthis.activeMenu.scrollTop( scroll + offset );\r\n\t\t\t} else if ( offset + itemHeight > elementHeight ) {\r\n\t\t\t\tthis.activeMenu.scrollTop( scroll + offset - elementHeight + itemHeight );\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tblur: function( event, fromFocus ) {\r\n\t\tif ( !fromFocus ) {\r\n\t\t\tclearTimeout( this.timer );\r\n\t\t}\r\n\r\n\t\tif ( !this.active ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._removeClass( this.active.children( \".ui-menu-item-wrapper\" ),\r\n\t\t\tnull, \"ui-state-active\" );\r\n\r\n\t\tthis._trigger( \"blur\", event, { item: this.active } );\r\n\t\tthis.active = null;\r\n\t},\r\n\r\n\t_startOpening: function( submenu ) {\r\n\t\tclearTimeout( this.timer );\r\n\r\n\t\t// Don't open if already open fixes a Firefox bug that caused a .5 pixel\r\n\t\t// shift in the submenu position when mousing over the caret icon\r\n\t\tif ( submenu.attr( \"aria-hidden\" ) !== \"true\" ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.timer = this._delay( function() {\r\n\t\t\tthis._close();\r\n\t\t\tthis._open( submenu );\r\n\t\t}, this.delay );\r\n\t},\r\n\r\n\t_open: function( submenu ) {\r\n\t\tvar position = $.extend( {\r\n\t\t\tof: this.active\r\n\t\t}, this.options.position );\r\n\r\n\t\tclearTimeout( this.timer );\r\n\t\tthis.element.find( \".ui-menu\" ).not( submenu.parents( \".ui-menu\" ) )\r\n\t\t\t.hide()\r\n\t\t\t.attr( \"aria-hidden\", \"true\" );\r\n\r\n\t\tsubmenu\r\n\t\t\t.show()\r\n\t\t\t.removeAttr( \"aria-hidden\" )\r\n\t\t\t.attr( \"aria-expanded\", \"true\" )\r\n\t\t\t.position( position );\r\n\t},\r\n\r\n\tcollapseAll: function( event, all ) {\r\n\t\tclearTimeout( this.timer );\r\n\t\tthis.timer = this._delay( function() {\r\n\r\n\t\t\t// If we were passed an event, look for the submenu that contains the event\r\n\t\t\tvar currentMenu = all ? this.element :\r\n\t\t\t\t$( event && event.target ).closest( this.element.find( \".ui-menu\" ) );\r\n\r\n\t\t\t// If we found no valid submenu ancestor, use the main menu to close all\r\n\t\t\t// sub menus anyway\r\n\t\t\tif ( !currentMenu.length ) {\r\n\t\t\t\tcurrentMenu = this.element;\r\n\t\t\t}\r\n\r\n\t\t\tthis._close( currentMenu );\r\n\r\n\t\t\tthis.blur( event );\r\n\r\n\t\t\t// Work around active item staying active after menu is blurred\r\n\t\t\tthis._removeClass( currentMenu.find( \".ui-state-active\" ), null, \"ui-state-active\" );\r\n\r\n\t\t\tthis.activeMenu = currentMenu;\r\n\t\t}, all ? 0 : this.delay );\r\n\t},\r\n\r\n\t// With no arguments, closes the currently active menu - if nothing is active\r\n\t// it closes all menus.  If passed an argument, it will search for menus BELOW\r\n\t_close: function( startMenu ) {\r\n\t\tif ( !startMenu ) {\r\n\t\t\tstartMenu = this.active ? this.active.parent() : this.element;\r\n\t\t}\r\n\r\n\t\tstartMenu.find( \".ui-menu\" )\r\n\t\t\t.hide()\r\n\t\t\t.attr( \"aria-hidden\", \"true\" )\r\n\t\t\t.attr( \"aria-expanded\", \"false\" );\r\n\t},\r\n\r\n\t_closeOnDocumentClick: function( event ) {\r\n\t\treturn !$( event.target ).closest( \".ui-menu\" ).length;\r\n\t},\r\n\r\n\t_isDivider: function( item ) {\r\n\r\n\t\t// Match hyphen, em dash, en dash\r\n\t\treturn !/[^\\-\\u2014\\u2013\\s]/.test( item.text() );\r\n\t},\r\n\r\n\tcollapse: function( event ) {\r\n\t\tvar newItem = this.active &&\r\n\t\t\tthis.active.parent().closest( \".ui-menu-item\", this.element );\r\n\t\tif ( newItem && newItem.length ) {\r\n\t\t\tthis._close();\r\n\t\t\tthis.focus( event, newItem );\r\n\t\t}\r\n\t},\r\n\r\n\texpand: function( event ) {\r\n\t\tvar newItem = this.active && this._menuItems( this.active.children( \".ui-menu\" ) ).first();\r\n\r\n\t\tif ( newItem && newItem.length ) {\r\n\t\t\tthis._open( newItem.parent() );\r\n\r\n\t\t\t// Delay so Firefox will not hide activedescendant change in expanding submenu from AT\r\n\t\t\tthis._delay( function() {\r\n\t\t\t\tthis.focus( event, newItem );\r\n\t\t\t} );\r\n\t\t}\r\n\t},\r\n\r\n\tnext: function( event ) {\r\n\t\tthis._move( \"next\", \"first\", event );\r\n\t},\r\n\r\n\tprevious: function( event ) {\r\n\t\tthis._move( \"prev\", \"last\", event );\r\n\t},\r\n\r\n\tisFirstItem: function() {\r\n\t\treturn this.active && !this.active.prevAll( \".ui-menu-item\" ).length;\r\n\t},\r\n\r\n\tisLastItem: function() {\r\n\t\treturn this.active && !this.active.nextAll( \".ui-menu-item\" ).length;\r\n\t},\r\n\r\n\t_menuItems: function( menu ) {\r\n\t\treturn ( menu || this.element )\r\n\t\t\t.find( this.options.items )\r\n\t\t\t.filter( \".ui-menu-item\" );\r\n\t},\r\n\r\n\t_move: function( direction, filter, event ) {\r\n\t\tvar next;\r\n\t\tif ( this.active ) {\r\n\t\t\tif ( direction === \"first\" || direction === \"last\" ) {\r\n\t\t\t\tnext = this.active\r\n\t\t\t\t\t[ direction === \"first\" ? \"prevAll\" : \"nextAll\" ]( \".ui-menu-item\" )\r\n\t\t\t\t\t.last();\r\n\t\t\t} else {\r\n\t\t\t\tnext = this.active\r\n\t\t\t\t\t[ direction + \"All\" ]( \".ui-menu-item\" )\r\n\t\t\t\t\t.first();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif ( !next || !next.length || !this.active ) {\r\n\t\t\tnext = this._menuItems( this.activeMenu )[ filter ]();\r\n\t\t}\r\n\r\n\t\tthis.focus( event, next );\r\n\t},\r\n\r\n\tnextPage: function( event ) {\r\n\t\tvar item, base, height;\r\n\r\n\t\tif ( !this.active ) {\r\n\t\t\tthis.next( event );\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif ( this.isLastItem() ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif ( this._hasScroll() ) {\r\n\t\t\tbase = this.active.offset().top;\r\n\t\t\theight = this.element.height();\r\n\t\t\tthis.active.nextAll( \".ui-menu-item\" ).each( function() {\r\n\t\t\t\titem = $( this );\r\n\t\t\t\treturn item.offset().top - base - height < 0;\r\n\t\t\t} );\r\n\r\n\t\t\tthis.focus( event, item );\r\n\t\t} else {\r\n\t\t\tthis.focus( event, this._menuItems( this.activeMenu )\r\n\t\t\t\t[ !this.active ? \"first\" : \"last\" ]() );\r\n\t\t}\r\n\t},\r\n\r\n\tpreviousPage: function( event ) {\r\n\t\tvar item, base, height;\r\n\t\tif ( !this.active ) {\r\n\t\t\tthis.next( event );\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif ( this.isFirstItem() ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif ( this._hasScroll() ) {\r\n\t\t\tbase = this.active.offset().top;\r\n\t\t\theight = this.element.height();\r\n\t\t\tthis.active.prevAll( \".ui-menu-item\" ).each( function() {\r\n\t\t\t\titem = $( this );\r\n\t\t\t\treturn item.offset().top - base + height > 0;\r\n\t\t\t} );\r\n\r\n\t\t\tthis.focus( event, item );\r\n\t\t} else {\r\n\t\t\tthis.focus( event, this._menuItems( this.activeMenu ).first() );\r\n\t\t}\r\n\t},\r\n\r\n\t_hasScroll: function() {\r\n\t\treturn this.element.outerHeight() < this.element.prop( \"scrollHeight\" );\r\n\t},\r\n\r\n\tselect: function( event ) {\r\n\r\n\t\t// TODO: It should never be possible to not have an active item at this\r\n\t\t// point, but the tests don't trigger mouseenter before click.\r\n\t\tthis.active = this.active || $( event.target ).closest( \".ui-menu-item\" );\r\n\t\tvar ui = { item: this.active };\r\n\t\tif ( !this.active.has( \".ui-menu\" ).length ) {\r\n\t\t\tthis.collapseAll( event, true );\r\n\t\t}\r\n\t\tthis._trigger( \"select\", event, ui );\r\n\t},\r\n\r\n\t_filterMenuItems: function( character ) {\r\n\t\tvar escapedCharacter = character.replace( /[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\" ),\r\n\t\t\tregex = new RegExp( \"^\" + escapedCharacter, \"i\" );\r\n\r\n\t\treturn this.activeMenu\r\n\t\t\t.find( this.options.items )\r\n\r\n\t\t\t\t// Only match on items, not dividers or other content (#10571)\r\n\t\t\t\t.filter( \".ui-menu-item\" )\r\n\t\t\t\t\t.filter( function() {\r\n\t\t\t\t\t\treturn regex.test(\r\n\t\t\t\t\t\t\t$.trim( $( this ).children( \".ui-menu-item-wrapper\" ).text() ) );\r\n\t\t\t\t\t} );\r\n\t}\r\n} );\r\n\r\n});\r\n"]}